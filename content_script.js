(()=>{"use strict";const e={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let t;const n=new Uint8Array(16);function o(){if(!t&&(t="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!t))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(n)}const r=[];for(let b=0;b<256;++b)r.push((b+256).toString(16).slice(1));function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]).toLowerCase()}const s=function(t,n,r){if(e.randomUUID&&!n&&!t)return e.randomUUID();const s=(t=t||{}).random||(t.rng||o)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,n){r=r||0;for(let e=0;e<16;++e)n[r+e]=s[e];return n}return i(s)},d=e=>{throw console.error(e),new Error(`should never be reached ${e}`)},a="zeal_widget",c=JSON.parse(localStorage.getItem(a)||"{}"),p=s();let h=null,l=[];const g=new BroadcastChannel(p);g.addEventListener("message",(e=>{if(e.origin===window.location.origin){const t=e.data;h?h.postMessage(t):l.push(t)}}));const u=document.createElement("script");u.src=chrome.runtime.getURL(`inpage.js?instanceId=${p}`);const m=document.head||document.documentElement;m.prepend(u),m.removeChild(u);const w=document.createElement("iframe"),y=new URLSearchParams;y.append("dAppUrl",window.location.hostname),y.append("instanceId",p),y.append("type","zwidget"),w.allow="hid",w.src=chrome.runtime.getURL(`index.html?${y.toString()}`),w.width="0px",w.height="0px",w.style.position="fixed",w.style.position="fixed",w.style.top=`${c.top||100}px`,w.style.right=(c.right?window.innerWidth-c.right:24)+"px",w.style.border="none",w.style.boxShadow="rgba(0, 0, 0, 0.24) 0px 3px 8px",w.style.borderRadius="12px",w.style.pointerEvents="auto",w.style.zIndex="10000000000",window.addEventListener("message",(e=>{var t;e.source===w.contentWindow&&("ready"===(null===(t=e.data)||void 0===t?void 0:t.type)&&(h=chrome.runtime.connect(void 0,{name:p}),l.forEach((e=>{h.postMessage(e)})),l=[],h.onMessage.addListener((e=>{switch(e.type){case"disconnect":case"account_change":case"rpc_response":case"network_change":g.postMessage(e);break;case"drag":w.style.top=`${parseInt(w.style.top,10)+e.movement.y}px`,w.style.right=parseInt(w.style.right,10)-e.movement.x+"px",x(w),localStorage.setItem(a,JSON.stringify(w.getBoundingClientRect()));break;case"change_iframe_size":let t={width:w.width,height:w.height};switch(e.size){case"icon":t.width="36px",t.height="36px";break;case"small":t.width="360px",t.height="200px";break;case"large":t.width="360px",t.height="600px";break;default:return d(e.size)}w.width=t.width,w.height=t.height,w.style.width=t.width,w.style.height=t.height,x(w);break;default:return d(e)}}))))}));const x=e=>{const t=e.getBoundingClientRect();t.left<0&&(e.style.right=parseInt(e.style.right,10)+t.left-20+"px"),t.bottom>=window.innerHeight&&(e.style.top=parseInt(e.style.top,10)-(t.bottom-window.innerHeight)-20+"px"),t.top<0&&(e.style.top="20px"),t.right>=window.innerWidth&&(e.style.right="20px")},f=new MutationObserver((function(){document.body&&(document.body.append(w),x(w),f.disconnect())}));f.observe(document.documentElement,{childList:!0})})();
//# sourceMappingURL=main.c044055c.js.map