(()=>{"use strict";var e,t=new Uint8Array(16);function s(){if(!e&&!(e="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(t)}const r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const n=function(e){return"string"===typeof e&&r.test(e)};for(var i=[],o=0;o<256;++o)i.push((o+256).toString(16).substr(1));const c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase();if(!n(s))throw TypeError("Stringified UUID is invalid");return s};const a=function(e,t,r){var n=(e=e||{}).random||(e.rng||s)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return c(n)},h=e=>{const t=JSON.stringify(e);throw console.error(JSON.stringify(t)),new Error(`should never be reached ${t}`)};class d extends class{constructor(){this.listeners={}}on(e,t){return this.listeners.hasOwnProperty(e)||(this.listeners[e]=[]),this.listeners[e].push(t),this}removeListener(e,t){return this.listeners[e]=this.listeners[e].filter((e=>e===t)),this}emit(e){if(!this.listeners.hasOwnProperty(e))return null;for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];for(let n=0;n<this.listeners[e].length;n++){this.listeners[e][n].call(this,...s)}}}{enable(){return this.request({method:"eth_requestAccounts"})}networkVersion(){return this.request({method:"net_version"})}constructor(e){super(),this.cache={},this.bcm=void 0,this.isDAppInfoSent=!1,this.chainId=void 0,this.selectedAddress=void 0,this.isMetaMask=!0,this.bcm=new BroadcastChannel(e),this.bcm.addEventListener("message",(e=>{const{data:t}=e;switch(t.type){case"disconnect":this.chainId=void 0,this.selectedAddress=void 0,this.emit("disconnect"),this.emit("accountsChanged",[]);break;case"account_change":this.selectedAddress=t.account,this.emit("accountsChanged",[t.account]);break;case"rpc_response":const{response:e,id:s}=t,r=this.cache[s];if(!r)return void console.error("no resolver for request id",s);delete this.cache[s];const{reject:n,resolve:i}=r;switch(e.type){case"success":i(e.data);break;case"failure":n(e.reason);break;default:return h(e)}break;case"network_change":this.chainId=t.chainId,this.emit("chainChanged",t.chainId);break;default:return h(t)}}))}sendAsync(e,t){return this.request(e).then((s=>(t&&t(void 0,{jsonrpc:"2.0",method:e.method,result:s}),s))).catch((s=>{throw t&&t(s,{jsonrpc:"2.0",method:e.method,error:s}),s}))}send(e,t){if("eth_accounts"===e)return[this.selectedAddress];if("string"!==typeof e||t&&!Array.isArray(t)){if("object"===typeof e&&t instanceof Function)return this.sendAsync(e,t);throw new Error(`un supported sync call to send ${e}`)}{const s={method:e,params:t||[]};return this.sendAsync(s)}}request(e){if(!this.isDAppInfoSent){var t;const e={type:"dapp_information",hostname:window.location.hostname,icon:null===(t=document.querySelector("link[rel~='icon']"))||void 0===t?void 0:t.href,name:document.title};this.bcm.postMessage(e),this.isDAppInfoSent=!0}const s={type:"rpc_request",request:{id:a(),method:e.method,params:e.params}};return new Promise(((e,t)=>{this.cache[s.request.id]={resolve:e,reject:t},this.bcm.postMessage(s)}))}}const u=document.currentScript;if(u&&"src"in u){const e=new URL(u.src),t=new URLSearchParams(e.searchParams).get("instanceId");if(t){const e=new d(t);Object.defineProperty(window,"ethereum",{value:e,writable:!1}),window.dispatchEvent(new Event("ethereum#initialized"))}}})();
//# sourceMappingURL=main.473d95f5.js.map